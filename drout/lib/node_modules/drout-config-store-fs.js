const fs = require("fs");
const Drout = require("drout");

class DroutConfigStoreFs {
  /**
   * render a config object
   * @param options drout options object
   * @param options.path filepath to config file
   */
  static render(options) {
    try {
      const configOptions = JSON.parse(fs.readFileSync(options.path));
      configOptions.inherited = Object.assign({}, options.inherited, configOptions.inherited);
      configOptions.inherited["drout-config-store"] = this.update;

      return Drout.render(configOptions);
    } catch(err) {
      console.error("drout-config-store-fs unable to parse options from path", err);
      return null;
    }
  }

  static update(config, options) {
    // TODO update config here
    console.error("TODO implement DroutConfigStoreFs update function");
    console.log(config, options);
  }
}

module.exports = DroutConfigStoreFs;
